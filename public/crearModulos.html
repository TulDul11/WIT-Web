<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Crear Módulo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <link rel="stylesheet" href="estilos.css"> <!-- Tu propio CSS aquí -->
  <style>
    #editor-container {
      background: white;
      border-radius: 10px;
      padding: 15px;
      min-height: 200px;
    }
    .question-block {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body class="login_body">

  <div id="login_container" class="w-100 px-4" style="max-width: 900px;">
    <h2 class="text-white text-center mb-4">Crear nuevo módulo</h2>

    <!-- Título -->
    <input id="login_user" type="text" placeholder="Título del módulo" class="form-control mb-4">

    <!-- Editor de contenido libre -->
    <label class="text-white mb-2">Contenido del módulo:</label>
    <div id="editor-container"></div>

    <!-- Preguntas del videojuego -->
    <div class="mt-5">
      <h4 class="text-white mb-3">Banco de preguntas para el videojuego</h4>
      <div id="questions-container"></div>
      <button class="btn btn-light" onclick="agregarPregunta()">+ Añadir pregunta</button>
    </div>

    <!-- Guardar -->
    <button id="login_button" class="btn w-100 mt-4">Guardar módulo</button>
  </div>

  <!-- Librerías -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

  <script>
    // Iniciar Quill
    const quill = new Quill('#editor-container', {
      theme: 'snow',
      placeholder: 'Escribe aquí el contenido del módulo...',
      modules: {
        toolbar: [
          [{ header: [1, 2, 3, false] }],
          ['bold', 'italic', 'underline', 'link'],
          [{ list: 'ordered' }, { list: 'bullet' }],
          ['image']
        ]
      }
    });

    // Añadir preguntas
    let preguntaIndex = 0;

    function agregarPregunta() {
      const container = document.getElementById('questions-container');
      const block = document.createElement('div');
      block.className = 'question-block';

      block.innerHTML = `
        <label>Pregunta:</label>
        <input type="text" class="form-control mb-2" name="pregunta_${preguntaIndex}">

        <label>Respuestas:</label>
        ${[0, 1, 2, 3].map(i => `
          <div class="input-group mb-2">
            <div class="input-group-text">
              <input type="radio" name="correcta_${preguntaIndex}" value="${i}" required>
            </div>
            <input type="text" class="form-control" name="respuesta_${preguntaIndex}_${i}" placeholder="Respuesta ${i + 1}">
          </div>
        `).join('')}
      `;

      container.appendChild(block);
      preguntaIndex++;
    }

    // Guardar módulo (prototipo: imprime en consola)
    document.getElementById('login_button').addEventListener('click', () => {
      const titulo = document.getElementById('login_user').value;
      const contenidoHTML = quill.root.innerHTML;

      const preguntas = [];
      for (let i = 0; i < preguntaIndex; i++) {
        const pregunta = document.querySelector(`input[name=pregunta_${i}]`)?.value;
        const respuestas = [];
        for (let j = 0; j < 4; j++) {
          respuestas.push(document.querySelector(`input[name=respuesta_${i}_${j}]`)?.value);
        }
        const correcta = document.querySelector(`input[name=correcta_${i}]:checked`)?.value;

        if (pregunta && respuestas.every(r => r) && correcta !== undefined) {
          preguntas.push({
            pregunta,
            respuestas,
            correcta: parseInt(correcta)
          });
        }
      }

      console.log({
        titulo,
        contenido: contenidoHTML,
        preguntas
      });

      alert('¡Módulo capturado! (ver consola)');
    });
  </script>
</body>
</html>
